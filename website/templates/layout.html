{% load static %}

<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" type="image/x-icon" href="{% static 'favicon/favicon.ico' %}">
        <title>{% block title %}{% endblock %}</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
        <link rel="stylesheet" href="{% static 'website/styles.css' %}">
        {% block extra_js %}{% endblock %}
    </head>

    <body>
        <main>
            <header>
                <nav class="navbar navbar-expand-lg navbar-dark bg-transparent fixed-top">
                    <div class="container-fluid">
                        <a class="navbar-brand" href="{% url 'homepage' %}"><img src="{% static 'website/AAC Logo.webp' %}"></a>

                        <!--Toggle Btn-->
                        <button class="navbar-toggler shadow-none border-0" type="button" data-bs-toggle="offcanvas"
                            data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>

                        <!--Side Bar-->
                        <div class="sidebar offcanvas offcanvas-start" tabindex="-1" id="offcanvasNavbar"
                            aria-labelledby="offcanvasNavbarLabel">

                            <!--Side Bar Header-->
                            <div class="offcanvas-header text-white border-bottom">
                                <h5 class="offcanvas-title" id="offcanvasNavbarLabel">AAC</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                            </div>

                            <div class="offcanvas-body">
                                <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                                    <li class="nav-item">
                                        <a class="nav-link active" aria-current="page" href="{% url 'homepage' %}">Home</a>
                                    </li>
                                    <!--
                                    <li class="nav-item">
                                        <a class="nav-link" href="#" >Projects</a>
                                    </li>
                                    -->
                                    <li class="nav-item">
                                        <a class="nav-link" href="{% url 'events' %}">Events</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="{% url 'photo-gallery' %}">Photo Gallery</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="{% url 'blogs' %}">Blog</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="{% url 'teams' %}">Team</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="{% url 'about' %}">About</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </nav>
            </header>
            <div id="scroll-sentinel" style="position: relative; width: 1px; height: 1px; margin: 0; padding: 0;"></div>

            {% block content %}
            {% endblock %}
            <footer>
                <div class="footer-container">
                    <p>&copy; 2025 Amateur Astronomy Club. Made with âœ¨ for stargazers everywhere.</p>
                    <div class="social-links">
                        <a href="http://www.youtube.com/@amateurastronomyclubnitk3007"><img src="{% static 'footer-icons/Youtube.webp' %}" alt="youtube"></a>
                        <a href="https://www.instagram.com/aac.nitk/"><img src="{% static 'footer-icons/Instagram.webp' %}" alt="instagram"></a>
                    </div>
                </div>
            </footer>
        </main>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
            crossorigin="anonymous">
        </script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
            const navbar = document.querySelector("nav.navbar") || document.querySelector(".navbar");
            if (!navbar) {
                console.warn("Navbar not found: selector tried 'nav.navbar' and '.navbar'");
                return;
            }

            const sentinel = document.getElementById("scroll-sentinel");
            // debug
            console.log("Navbar scroll helper attached. Navbar classes:", navbar.className, "Sentinel:", !!sentinel);

            // Helper: toggle classes
            function setScrolled(on) {
                if (on) {
                if (!navbar.classList.contains("scrolled")) navbar.classList.add("scrolled", "shadow-sm");
                } else {
                if (navbar.classList.contains("scrolled")) navbar.classList.remove("scrolled", "shadow-sm");
                }
            }

            // 1) Preferred: IntersectionObserver on sentinel (works even if scroll happens on a container)
            if (window.IntersectionObserver && sentinel) {
                const io = new IntersectionObserver((entries) => {
                // when sentinel is not intersecting (i.e. scrolled past), set scrolled = true
                entries.forEach(entry => {
                    setScrolled(!entry.isIntersecting);
                    // debug
                    // console.log('IO:', entry.isIntersecting, entry.boundingClientRect.y);
                });
                }, {
                root: null,    // viewport
                threshold: 0,  // any intersection
                rootMargin: "-12px 0px 0px 0px" // small offset, triggers a little earlier
                });
                io.observe(sentinel);

                // run once to set initial state (in case page loaded scrolled)
                // get computed intersection by checking bounding rect
                const rect = sentinel.getBoundingClientRect();
                setScrolled(rect.top < 0 || rect.bottom <= 0);
            } else {
                // 2) Fallback: window/document scroll listener
                function onScrollFallback() {
                const scrollTop = window.scrollY || document.documentElement.scrollTop || (document.scrollingElement && document.scrollingElement.scrollTop) || 0;
                setScrolled(scrollTop > 10);
                }
                // initial
                onScrollFallback();
                window.addEventListener("scroll", onScrollFallback, { passive: true });
                window.addEventListener("resize", onScrollFallback, { passive: true });
            }

            // Extra safety: detect if some element is capturing scroll (common in weird layouts).
            // If that happens, user can run in console: document.scrollingElement to inspect.
            });
        </script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
            const navbar = document.querySelector("nav.navbar");
            const offcanvas = document.getElementById("offcanvasNavbar");

            offcanvas.addEventListener("show.bs.offcanvas", () => {
                navbar.classList.add("offcanvas-open");
            });

            offcanvas.addEventListener("hidden.bs.offcanvas", () => {
                navbar.classList.remove("offcanvas-open");
            });
            });
        </script>
    </body>

</html>
